<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rye&display=swap" rel="stylesheet">
    <script src="vendor/vue.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest Map</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <div class="form-outter-container" v-if="page==1">
            <img :src=meta.config.image alt="Quest Image" class="quest-image">
            <p>{{ meta.config.desc }}</p>
        </div>
        <div class="form-outter-container" v-if="page==2">
            <div>
                <div class="li-div" v-for="quest in quests">
                    <div>{{ quest.name }} : {{quest.desc}}</div>
                    <button @click="editQuest(quest.id)">Edit Quest</button>
                    <button @click="selectQuest(quest.id)">View Steps</button>
                </div>
            </div>
            <div class="li-div" >
                <button @click="addQuest()">Add Quest</button>
            </div>
        </div>
        <div class="form-outter-container" v-if="page==3">
            <div>
                <div class="li-div quest-item" v-for="quest_entry in quest_entries">
                    <div class="left-quest">
                        <div class="quest-item"><h3>Quest:</h3> <p>{{ quest_entry.quest }}</p></div>
                        <div class="quest-item"><h3>Step:</h3> <p>{{ quest_entry.id }}</p></div>
                        <div class="quest-item" v-if="quest_entry.config.requirements">
                            <h3>Requirements:</h3>
                            <ul>
                                <div class="requirement" v-if="quest_entry.config.requirements.coords">
                                    <template v-if="quest_entry.config.requirements.coords.x!==0">
                                        <li><h3>Coords:</h3>  <p>&lt; {{ quest_entry.config.requirements.coords.x }}, {{ quest_entry.config.requirements.coords.y }}, {{ quest_entry.config.requirements.coords.z }} ></p> <h3>Radius:</h3> <p>{{ quest_entry.config.requirements.coords.r }}</p></li>
                                    </template>
                                </div>
                                <template v-if="quest_entry.config.requirements.items && quest_entry.config.rewards.items.length > 0">
                                    <div class="requirement" v-for="requirement in quest_entry.config.requirements.items">
                                        <li><p>{{ requirement.item }} x {{ requirement.count }}</p></li>
                                    </div>
                                </template>
                                <div class="requirement" v-else>
                                    <li>No Items</li>
                                </div>
                            </ul>
                        </div>
                        <div class="quest-item" v-if="quest_entry.config.materials">
                            <h3>Materials:</h3>
                            <ul>
                                <div class="requirement" v-if="quest_entry.config.materials.cash">
                                    <li><h3>Cash:</h3> <p>{{ quest_entry.config.materials.cash }}</p></li>
                                </div>
                                <template v-if="quest_entry.config.materials.items && quest_entry.config.materials.items.length > 0">
                                    <div class="requirement" v-for="requirement in quest_entry.config.materials.items">
                                        <li><p>{{ requirement.item }} x {{ requirement.count }}</p></li>
                                    </div>
                                </template>
                                <div class="requirement" v-else>
                                    <li>No Items</li>
                                </div>
                            </ul>
                        </div>
                        <div class="quest-item" v-if="quest_entry.config.rewards">
                            <h3>Rewards:</h3>
                            <ul>
                                <div class="requirement" v-if="quest_entry.config.rewards.cash">
                                    <li>><h3>Cash</h3> <p>{{ quest_entry.config.rewards.cash }}</p></li>
                                </div>
                                <template v-if="quest_entry.config.rewards.items && quest_entry.config.rewards.items.length > 0">
                                    <div class="requirement" v-for="requirement in quest_entry.config.rewards.items">
                                        <li><p>{{ requirement.item }} x {{ requirement.count }}</p></li>
                                    </div>
                                </template>
                                <div class="requirement" v-else>
                                    <li>No Items</li>
                                </div>
                            </ul>
                        </div>
                        <div class="quest-item" v-if="quest_entry.config.next">
                            <h3>Next Step:</h3> <p>{{ quest_entry.config.next }}</p>
                        </div>
                        <div>
                            <button @click="editQuestEntry(quest_entry.id)">Edit Entry</button>
                        </div>
                    </div>
                    <div class="right-quest">
                        <img :src=quest_entry.config.image alt="Quest Image" class="quest-image" v-if="quest_entry.config.image">
                        <div v-if="quest_entry.config.desc">{{ quest_entry.config.desc }}</div>
                    </div>
                </div>
            </div>
            <div class="li-div">
                <button @click="addQuestEntry(quest_id)">Add Quest</button>
                <button @click="setpage(2)">Back</button>
            </div>
        </div>
        <div class="form-outter-container" v-if="page==4">
            <div class="form-inner-container">
                <label for="quest_name">Quest Name:</label>
                <input type="text" id="quest_name" v-model="quest_name">
                <label for="quest_desc">Quest Description:</label>
                <input type="text" id="quest_desc" v-model="quest_desc">
                <button @click="saveQuest(quest_id)">Save</button>
                <button @click="delQuest(quest_id)">Delete</button>
                <button @click="setpage(2)">Back</button>
            </div>
        </div>
        <div class="form-outter-container" v-if="page==5">
            <div class="form-inner-container">
                <div>
                <label for="questentry.config.image">Image:</label><input type="text" id="questentry.config.image" v-model="questentry.config.image">
                <label for="questentry.config.desc">Description:</label><input type="text" id="quest_desc" v-model="questentry.config.desc">
                </div>
                <div>
                    Requirements:
                    <label for="questentry.config.requirements.coords">Coords:</label><input type="text" id="questentry.config.requirements.coords.x" v-model.number="questentry.config.requirements.coords.x"><input type="text" id="questentry.config.requirements.coords.y" v-model.number="questentry.config.requirements.coords.y"><input type="text" id="questentry.config.requirements.coords.z" v-model.number="questentry.config.requirements.coords.z"><label for="questentry.config.requirements.coords.r">Coords:</label><input type="text" id="questentry.config.requirements.coords.r" v-model.number="questentry.config.requirements.coords.r">
                    <div>
                        <ul>
                            <li v-for="(requirement, index) in questentry.config.requirements.items" :key="index">
                                {{requirement.item}} x {{requirement.count}}
                                <button @click="questentry.config.requirements.items.splice(index, 1)">Delete</button>
                            </li>
                            <li>
                                <label for="newrequirement.item">Item:</label><input type="text" id="newrequirement.item" v-model="newrequirement.item"><label for="newrequirement.count">Count:</label><input type="text" id="newrequirement.count" v-model.number="newrequirement.count">
                                <button @click="addRequirement(0)">Add</button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div>
                    Materials:
                    <label for="questentry.config.materials.cash">Cash:</label><input type="text" id="questentry.config.materials.cash" v-model.number="questentry.config.materials.cash">
                    <ul>
                        <li v-for="(materials, index) in questentry.config.materials.items" :key="index">
                            {{materials.item}} x {{materials.count}}
                            <button @click="questentry.config.materials.items.splice(index, 1)">Delete</button>
                        </li>
                        <li>
                            <label for="newrequirement.item">Item:</label><input type="text" id="newrequirement.item" v-model="newrequirement.item"><label for="newrequirement.count">Count:</label><input type="text" id="newrequirement.count" v-model.number="newrequirement.count">
                            <button @click="addRequirement(1)">Add</button>
                        </li>
                    </ul>
                </div>
                <div>
                    Rewards:
                    <label for="questentry.config.rewards.cash">Cash:</label><input type="text" id="questentry.config.rewards.cash" v-model.number="questentry.config.rewards.cash">
                    <ul>
                        <li v-for="(rewards, index) in questentry.config.rewards.items" :key="index">
                            {{rewards.item}} x {{rewards.count}}
                            <button @click="questentry.config.rewards.items.splice(index, 1)">Delete</button>
                        </li>
                        <li>
                            <label for="newrequirement.item">Item:</label><input type="text" id="newrequirement.item" v-model="newrequirement.item"><label for="newrequirement.count">Count:</label><input type="text" id="newrequirement.count" v-model.number="newrequirement.count">
                            <button @click="addRequirement(2)">Add</button>
                        </li>
                    </ul>
                </div>
                <div>
                    <label for="questentry.config.next">Next Step:</label><input type="text" id="questentry.config.next" v-model.number="questentry.config.next">
                </div>
                <button @click="updateEntry()">Save</button>
                <button @click="selectQuest(questentry.quest)">Back</button>
                <button @click="delQuestEntry(questentry.id,questentry.quest)">Delete Entry</button>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>